parameters:
    netgen_content_browser.controller.base.class: Netgen\Bundle\ContentBrowserBundle\Controller\API\Controller
    netgen_content_browser.controller.api.config.class: Netgen\Bundle\ContentBrowserBundle\Controller\API\ConfigController
    netgen_content_browser.controller.api.browse.class: Netgen\Bundle\ContentBrowserBundle\Controller\API\BrowseController
    netgen_content_browser.controller.api.search.class: Netgen\Bundle\ContentBrowserBundle\Controller\API\SearchController

    netgen_content_browser.event_listener.set_is_api_request.class: Netgen\Bundle\ContentBrowserBundle\EventListener\SetIsApiRequestListener
    netgen_content_browser.event_listener.set_current_config.class: Netgen\Bundle\ContentBrowserBundle\EventListener\SetCurrentConfigListener
    netgen_content_browser.event_listener.exception_conversion.class: Netgen\Bundle\ContentBrowserBundle\EventListener\ExceptionConversionListener
    netgen_content_browser.event_listener.exception_serializer.class: Netgen\Bundle\ContentBrowserBundle\EventListener\ExceptionSerializerListener

    netgen_content_browser.config_loader.chained.class: Netgen\Bundle\ContentBrowserBundle\Config\ChainedConfigLoader
    netgen_content_browser.config_loader.default.class: Netgen\Bundle\ContentBrowserBundle\Config\DefaultConfigLoader

    netgen_content_browser.registry.backend.class: Netgen\Bundle\ContentBrowserBundle\Registry\BackendRegistry

    netgen_content_browser.item_repository.class: Netgen\Bundle\ContentBrowserBundle\Item\ItemRepository
    netgen_content_browser.item_serializer.class: Netgen\Bundle\ContentBrowserBundle\Item\Serializer\ItemSerializer

    netgen_content_browser.item_configurator.class: Netgen\Bundle\ContentBrowserBundle\Item\Configurator\ItemConfigurator
    netgen_content_browser.item_renderer.class: Netgen\Bundle\ContentBrowserBundle\Item\Renderer\ItemRenderer
    netgen_content_browser.column_provider.class: Netgen\Bundle\ContentBrowserBundle\Item\ColumnProvider\ColumnProvider

    netgen_content_browser.form.type.content_browser.class: Netgen\Bundle\ContentBrowserBundle\Form\Type\ContentBrowserType

    netgen_content_browser.param_converter.item.class: Netgen\Bundle\ContentBrowserBundle\ParamConverter\ItemParamConverter

services:
    # Virtual services

    netgen_content_browser.current_config:
        synthetic: true

    # API controllers

    netgen_content_browser.controller.base:
        class: "%netgen_content_browser.controller.base.class%"
        arguments:
            - "@netgen_content_browser.item_repository"
            - "@netgen_content_browser.item_serializer"
            - "@netgen_content_browser.current_config"
        calls:
            - [setContainer, ["@service_container"]]

    netgen_content_browser.controller.api.config:
        class: "%netgen_content_browser.controller.api.config.class%"
        parent: netgen_content_browser.controller.base

    netgen_content_browser.controller.api.browse:
        class: "%netgen_content_browser.controller.api.browse.class%"
        parent: netgen_content_browser.controller.base

    netgen_content_browser.controller.api.search:
        class: "%netgen_content_browser.controller.api.search.class%"
        parent: netgen_content_browser.controller.base

    # Event listeners

    netgen_content_browser.event_listener.set_is_api_request:
        class: "%netgen_content_browser.event_listener.set_is_api_request.class%"
        tags:
            - { name: kernel.event_subscriber }

    netgen_content_browser.event_listener.set_current_config:
        class: "%netgen_content_browser.event_listener.set_current_config.class%"
        arguments:
            - "@netgen_content_browser.config_loader"
        calls:
            - [setContainer, ["@service_container"]]
        tags:
            - { name: kernel.event_subscriber }

    netgen_content_browser.event_listener.exception_conversion:
        class: "%netgen_content_browser.event_listener.exception_conversion.class%"
        tags:
            - { name: kernel.event_subscriber }

    netgen_content_browser.event_listener.exception_serializer:
        class: "%netgen_content_browser.event_listener.exception_serializer.class%"
        calls:
            - [setOutputDebugInfo, ["%kernel.debug%"]]
        tags:
            - { name: kernel.event_subscriber }

    # Config loaders

    netgen_content_browser.config_loader:
        alias: netgen_content_browser.config_loader.chained

    netgen_content_browser.config_loader.default:
        class: "%netgen_content_browser.config_loader.default.class%"
        calls:
            - [setContainer, ["@service_container"]]

    netgen_content_browser.config_loader.chained:
        class: "%netgen_content_browser.config_loader.chained.class%"
        arguments:
            - "@netgen_content_browser.config_loader.default"
            - []

    # Registries

    netgen_content_browser.registry.backend:
        class: "%netgen_content_browser.registry.backend.class%"

    # Main services

    netgen_content_browser.item_repository:
        class: "%netgen_content_browser.item_repository.class%"
        arguments:
            - "@netgen_content_browser.registry.backend"

    netgen_content_browser.item_serializer:
        class: "%netgen_content_browser.item_serializer.class%"
        arguments:
            - "@netgen_content_browser.item_repository"
            - "@netgen_content_browser.item_configurator"
            - "@netgen_content_browser.column_provider"
            - "@netgen_content_browser.item_renderer"

    netgen_content_browser.item_configurator:
        class: "%netgen_content_browser.item_configurator.class%"
        arguments:
            - "@netgen_content_browser.current_config"
            - []

    netgen_content_browser.item_renderer:
        class: "%netgen_content_browser.item_renderer.class%"
        arguments:
            - "@twig"
            - []

    netgen_content_browser.column_provider:
        class: "%netgen_content_browser.column_provider.class%"
        arguments:
            - "@netgen_content_browser.item_renderer"
            - "@netgen_content_browser.current_config"
            - []

    # Form types

    netgen_content_browser.form.type.content_browser:
        class: "%netgen_content_browser.form.type.content_browser.class%"
        tags:
            - { name: form.type }

    # Param converters

    netgen_content_browser.param_converter.item:
        class: "%netgen_content_browser.param_converter.item.class%"
        arguments:
            - "@netgen_content_browser.item_repository"
        tags:
            - { name: request.param_converter, priority: 0 }
