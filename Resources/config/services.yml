parameters:
    netgen_content_browser.controller.api.tree.class: Netgen\Bundle\ContentBrowserBundle\Controller\API\TreeController

    netgen_content_browser.ezpublish.location_builder.class: Netgen\Bundle\ContentBrowserBundle\Repository\EzPublish\LocationBuilder
    netgen_content_browser.ezpublish.adapter.class: Netgen\Bundle\ContentBrowserBundle\Repository\EzPublish\Adapter
    netgen_content_browser.repository.class: Netgen\Bundle\ContentBrowserBundle\Repository\Repository

    netgen_content_browser.event_listener.exception_conversion.class: Netgen\Bundle\ContentBrowserBundle\EventListener\ExceptionConversionListener

services:
    # API controllers

    netgen_content_browser.controller.api.tree:
        class: %netgen_content_browser.controller.api.tree.class%
        calls:
            - [setContainer, ["@service_container"]]

    # Adapters

    netgen_content_browser.adapter:
        alias: netgen_content_browser.ezpublish.adapter

    netgen_content_browser.ezpublish.location_builder:
        class: %netgen_content_browser.ezpublish.location_builder.class%
        arguments:
            - "@ezpublish.api.repository"
            - "@ezpublish.translation_helper"
            - "@ezpublish.field_helper"
            - "@ezpublish.fieldtype.ezimage.variation_service"
            - "%netgen_content_browser.adapters.ezpublish.image_fields%"

    netgen_content_browser.ezpublish.adapter:
        class: %netgen_content_browser.ezpublish.adapter.class%
        arguments:
            - "@ezpublish.api.service.search"
            - "@netgen_content_browser.ezpublish.location_builder"
        tags:
            - { name: netgen_content_browser.adapter, identifier: ezpublish }

    # Repository

    netgen_content_browser.repository:
        class: %netgen_content_browser.repository.class%
        shared: false
        arguments:
            - "@netgen_content_browser.adapter"

    # Event listeners

    netgen_content_browser.event_listener.exception_conversion:
        class: %netgen_content_browser.event_listener.exception_conversion.class%
        tags:
            - { name: kernel.event_subscriber }
